{"version":3,"sources":["../src/octokitFromAuth.ts"],"sourcesContent":["import { getGitHubAuthToken } from \"get-github-auth-token\";\nimport { Octokit } from \"octokit\";\n\nimport { OctokitOptions } from \"./types.js\";\n\nexport async function octokitFromAuth(\n\toptions?: OctokitOptions,\n): Promise<Octokit> {\n\tconst auth = await retrieveAuth(options?.auth as string | undefined);\n\n\treturn new Octokit({ ...options, auth });\n}\n\nasync function retrieveAuth(provided: string | undefined) {\n\tif (provided) {\n\t\treturn provided;\n\t}\n\n\tif (provided === \"\") {\n\t\tthrow new Error(\"Invalid auth provided: an empty string ('').\");\n\t}\n\n\tconst auth = await getGitHubAuthToken();\n\tif (auth.succeeded) {\n\t\treturn auth.token;\n\t}\n\n\tthrow new Error(\n\t\t\"Please provide an auth token (process.env.GH_TOKEN) or log in with the GitHub CLI (gh).\",\n\t\t{\n\t\t\tcause: auth.error,\n\t\t},\n\t);\n}\n"],"mappings":"AAAA,SAAS,0BAA0B;AACnC,SAAS,eAAe;AAIxB,eAAsB,gBACrB,SACmB;AACnB,QAAM,OAAO,MAAM,aAAa,SAAS,IAA0B;AAEnE,SAAO,IAAI,QAAQ,EAAE,GAAG,SAAS,KAAK,CAAC;AACxC;AAEA,eAAe,aAAa,UAA8B;AACzD,MAAI,UAAU;AACb,WAAO;AAAA,EACR;AAEA,MAAI,aAAa,IAAI;AACpB,UAAM,IAAI,MAAM,8CAA8C;AAAA,EAC/D;AAEA,QAAM,OAAO,MAAM,mBAAmB;AACtC,MAAI,KAAK,WAAW;AACnB,WAAO,KAAK;AAAA,EACb;AAEA,QAAM,IAAI;AAAA,IACT;AAAA,IACA;AAAA,MACC,OAAO,KAAK;AAAA,IACb;AAAA,EACD;AACD;","names":[]}